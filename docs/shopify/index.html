<!doctype html><html lang=en><head><meta charset=utf-8><meta http-equiv=x-ua-compatible content="ie=edge"><title>Shopify - Sprie Widget Docs</title><meta name=viewport content="width=device-width,initial-scale=1"><link rel=icon href=https://docs.sprie.io/favicon.ico><link rel=stylesheet href=/css/style.min.6719d72e323121369d5caeb4264b95d8a63cf1deaab029da67602fe5a046e0a4.css></head><body class="page page-default-single"><div id=main-menu-mobile class=main-menu-mobile><ul><li class=menu-item-home><a href=/><span>Home</span></a></li><li class=menu-item-docs><a href=/docs/><span>Docs</span></a></li></ul></div><div class=wrapper><div class=header><div class=container><div class=logo><a href=https://docs.sprie.io><img alt=Logo src=/images/logo.png></a></div><div class=logo-mobile><a href=https://docs.sprie.io><img alt=Logo src=/images/logo.png></a></div><div id=main-menu class=main-menu><ul><li class=menu-item-home><a href=/><span>Home</span></a></li><li class=menu-item-docs><a href=/docs/><span>Docs</span></a></li></ul></div><button id=toggle-main-menu-mobile class="hamburger hamburger--slider" type=button>
<span class=hamburger-box><span class=hamburger-inner></span></span></button></div></div><div class="container pt-2 pt-md-6 pb-3 pb-md-6"><div class=row><div class="col-12 col-md-3 mb-3"><div class=sidebar><div class=docs-menu><h4>Docs</h4><ul><li><a href=https://docs.sprie.io/docs/concept/>Concepts</a></li><li><a href=https://docs.sprie.io/docs/quick-start/>Quick Start Guide</a></li><li><a href=https://docs.sprie.io/docs/events/>Events</a></li><li><a href=https://docs.sprie.io/docs/methods/>Methods</a></li><li><a href=https://docs.sprie.io/docs/wordpress/>Wordpress</a></li><li class=active><a href=https://docs.sprie.io/docs/shopify/>Shopify</a></li><li><a href=https://docs.sprie.io/docs/react/>React</a></li><li><a href=https://docs.sprie.io/docs/troubleshoot/>Troubleshoot</a></li></ul></div></div></div><div class="col-12 col-md-9"><h1 class=title>Shopify</h1><div class=content><h2 id=demo>Demo</h2><p>Demo Link : <code>https://demo-sprie.myshopify.com/products/centena-bert-corn?variant=42471361609891</code><br>Password : <code>password</code>
Shopify App : Comming soon!</p><p>Shopify is an eCommerce website to sell, ship, and process payments. All the activities in Sprie happen in front end. What we can do is break the typical Sprie Workflow into several <code>liquid</code> files so that they all take care of specific actions on specific intents.</p><h2 id=summary>Summary</h2><ol><li>Initialise Sprie Widget at a common place</li><li>Add Preview Button</li><li>Translate skus from objects ids</li><li>check SKU Registration</li><li>Add to Cart</li><li>Handle Variants changes</li><li>Next Steps</li><li>Full Code</li></ol><h2 id=implementation>Implementation</h2><p>All the implementation work requires you to edit <code>.liquid</code> files, right off the admin editor:</p><ol><li>Go to <code>&lt;your-shopify-store>/admin</code> page and login (<code>https://mystore.myshopify.com/admin</code>)</li><li><code>Online Store > Themes > Actions > Edit Code</code></li><li>Select file from left Column, Edit/update/insert the code and click on <code>Save</code> on top right.</li></ol><p><img src=location.jpg alt="Code Editor Location" title="Location of Code Editor"></p><h3 id=1-initialise>1. Initialise</h3><p>We would want to initialise Sprie Widget in a place where that particular part of html gets rendered on every single page.
&lsquo;footer.liquid&rsquo; is a very good way to start initialising the widget.
Insert the follwing code in <code>sections > footer.liquid</code> file :</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-HTML data-lang=HTML><span class=line><span class=cl><span class=c>&lt;!-- Sprie --&gt;</span>
</span></span><span class=line><span class=cl><span class=p>&lt;</span><span class=nt>script</span> <span class=na>src</span><span class=o>=</span><span class=s>&#34;https://cdn.jsdelivr.net/npm/@perceptimagery/sprie-widget@latest&#34;</span><span class=p>&gt;&lt;/</span><span class=nt>script</span><span class=p>&gt;</span>
</span></span><span class=line><span class=cl><span class=p>&lt;</span><span class=nt>div</span> <span class=na>id</span><span class=o>=</span><span class=s>&#34;sdk-widget&#34;</span> <span class=na>data-apikey</span><span class=o>=</span><span class=s>&#34;&lt;your api key&gt;&#34;</span><span class=p>&gt;&lt;/</span><span class=nt>div</span><span class=p>&gt;</span>
</span></span></code></pre></div><h3 id=2-add-tryon-button>2. Add TryOn Button</h3><p>The <code>Preview</code> TryOn Button should be available where the main product is displayed (PDP - Product Display Page).
Head on to <code>sections > main-product.liquid</code> and put the following code around line number <code>440</code> buy buttons in <code>product-form__buttons</code> element :</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-HTML data-lang=HTML><span class=line><span class=cl><span class=p>&lt;</span><span class=nt>button</span>
</span></span><span class=line><span class=cl>	<span class=na>id</span><span class=o>=</span><span class=s>&#34;tryon-button&#34;</span>
</span></span><span class=line><span class=cl>	<span class=na>type</span><span class=o>=</span><span class=s>&#34;button&#34;</span>
</span></span><span class=line><span class=cl>	<span class=na>name</span><span class=o>=</span><span class=s>&#34;tryon&#34;</span>
</span></span><span class=line><span class=cl>	<span class=na>style</span><span class=o>=</span><span class=s>&#34;display:none&#34;</span> 
</span></span><span class=line><span class=cl>	<span class=na>onclick</span><span class=o>=</span><span class=s>&#34;SprieSDK.Load(currentVariantSku)&#34;</span>
</span></span><span class=line><span class=cl>	<span class=na>class</span><span class=o>=</span><span class=s>&#34;product-form__submit button button--full-width button--secondary&#34;</span>
</span></span><span class=line><span class=cl><span class=p>&gt;</span>
</span></span><span class=line><span class=cl>	<span class=p>&lt;</span><span class=nt>span</span><span class=p>&gt;</span> 	Try on <span class=p>&lt;/</span><span class=nt>span</span><span class=p>&gt;</span>
</span></span><span class=line><span class=cl><span class=p>&lt;/</span><span class=nt>button</span><span class=p>&gt;</span>
</span></span></code></pre></div><p>We will add <code>currentVariantSku</code> variable in the following steps.</p><p><img src=tryon-button.png alt></p><h3 id=3-setup-sku-translation>3. Setup SKU Translation</h3><p>We need a way to send the skus to the <code>Load</code> method of the widget to show it properly. Most often times, the SKUs are pre-registered during asset onboard process with Sprie. To acquire the proper skus:</p><ol><li>Either it can be generated uniquely and sent over to Sprie in a CSV,</li><li>or, just use the url param of a current item in a PDP ( Product Display Page).</li></ol><p>To use the url-param as sku, we would need to translate the <code>url</code> into an <code>sku</code>. Write the following code in <code>sections > footer.liquid</code> file after you have initialised Sprie Widget :</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-HTML data-lang=HTML><span class=line><span class=cl><span class=p>&lt;</span><span class=nt>script</span><span class=p>&gt;</span>
</span></span><span class=line><span class=cl>	<span class=kr>const</span> <span class=nx>params</span> <span class=o>=</span> <span class=k>new</span> <span class=nb>Proxy</span><span class=p>(</span><span class=k>new</span> <span class=nx>URLSearchParams</span><span class=p>(</span><span class=nb>window</span><span class=p>.</span><span class=nx>location</span><span class=p>.</span><span class=nx>search</span><span class=p>),</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>		<span class=nx>get</span><span class=o>:</span> <span class=p>(</span><span class=nx>searchParams</span><span class=p>,</span> <span class=nx>prop</span><span class=p>)</span> <span class=p>=&gt;</span> <span class=nx>searchParams</span><span class=p>.</span><span class=nx>get</span><span class=p>(</span><span class=nx>prop</span><span class=p>),</span>
</span></span><span class=line><span class=cl>	<span class=p>});</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>	<span class=c1>// Fetch Product Specific Data
</span></span></span><span class=line><span class=cl><span class=c1></span>	<span class=kr>const</span> <span class=nx>urlPath</span> <span class=o>=</span> <span class=nb>window</span><span class=p>.</span><span class=nx>location</span><span class=p>.</span><span class=nx>pathname</span><span class=p>;</span>
</span></span><span class=line><span class=cl>	<span class=kr>const</span> <span class=nx>productSku</span> <span class=o>=</span> <span class=nx>urlPath</span><span class=p>.</span><span class=nx>indexOf</span><span class=p>(</span><span class=s1>&#39;products/&#39;</span><span class=p>)</span><span class=o>&gt;=</span><span class=mi>0</span> <span class=o>?</span> <span class=nx>urlPath</span><span class=p>.</span><span class=nx>replace</span><span class=p>(</span><span class=s1>&#39;products&#39;</span><span class=p>,</span><span class=s1>&#39;&#39;</span><span class=p>).</span><span class=nx>replaceAll</span><span class=p>(</span><span class=s1>&#39;/&#39;</span><span class=p>,</span><span class=s1>&#39;&#39;</span><span class=p>).</span><span class=nx>trim</span><span class=p>()</span> <span class=o>:</span> <span class=s1>&#39;&#39;</span><span class=p>;</span>
</span></span><span class=line><span class=cl>  	<span class=kr>const</span> <span class=nx>currentVariantId</span> <span class=o>=</span> <span class=nx>params</span><span class=p>.</span><span class=nx>variant</span> <span class=o>||</span> <span class=kc>null</span><span class=p>;</span>
</span></span><span class=line><span class=cl>  	<span class=kr>const</span> <span class=nx>currentProduct</span><span class=o>=</span> <span class=p>{{</span> <span class=nx>product</span> <span class=o>|</span> <span class=nx>json</span> <span class=p>}};</span>
</span></span><span class=line><span class=cl>	<span class=kr>const</span> <span class=nx>variantIdSkuMap</span><span class=o>=</span> <span class=o>!!</span><span class=nx>currentProduct</span>  <span class=o>?</span> <span class=nx>currentProduct</span><span class=p>.</span><span class=nx>variants</span><span class=p>.</span><span class=nx>reduce</span><span class=p>(</span> <span class=p>(</span><span class=nx>acc</span><span class=p>,</span><span class=nx>curr</span><span class=p>)=&gt;{</span>      
</span></span><span class=line><span class=cl>			<span class=nx>acc</span><span class=p>[</span><span class=nx>curr</span><span class=p>.</span><span class=nx>id</span><span class=p>]</span><span class=o>=</span><span class=nx>curr</span><span class=p>.</span><span class=nx>sku</span> <span class=o>||</span> <span class=nx>productSku</span><span class=p>;</span>
</span></span><span class=line><span class=cl>			<span class=k>return</span> <span class=nx>acc</span><span class=p>;</span>
</span></span><span class=line><span class=cl>		<span class=p>},{})</span><span class=o>:</span> <span class=p>{};</span>
</span></span><span class=line><span class=cl>  	<span class=kd>let</span> <span class=nx>currentVariantSku</span> <span class=o>=</span> <span class=nx>variantIdSkuMap</span><span class=p>[</span><span class=nx>currentVariantId</span><span class=p>]</span> <span class=o>||</span> <span class=nx>productSku</span> <span class=o>||</span> <span class=kc>null</span><span class=p>;</span>
</span></span><span class=line><span class=cl>  	<span class=kr>const</span> <span class=nx>tryonButton</span> <span class=o>=</span> <span class=nb>document</span><span class=p>.</span><span class=nx>getElementById</span><span class=p>(</span><span class=s1>&#39;tryon-button&#39;</span><span class=p>);</span>
</span></span><span class=line><span class=cl><span class=p>&lt;/</span><span class=nt>script</span><span class=p>&gt;</span>
</span></span></code></pre></div><p>What we are essentially doing here is stripping the url param path, using Shopify API to get current product and/or variant and setting up <code>currentVariantSku</code>. If this value is not null, we can Load Sprie on click handler, or do a check with Sprie Network.</p><h3 id=4-check-sku-registration>4. Check SKU Registration</h3><p>From the above step, we get a sku for a specific product which we want to run through Sprie Check. Now Sprie authentication happens under the hood with the api key provided, and its a asynchronous task. Sprie exposes certain <a href=https://docs.sprie.io/docs/events>events</a> to let the developers know when certain actions happen, and how to listen to them.<br>In this case, we tap on to <code>onSDKReady</code> event to know when the authentication is done and Sprie is ready for use. Put the below code in the same <code>sections > footer.liquid</code> file after the above step.</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-JS data-lang=JS><span class=line><span class=cl><span class=c1>// Check SKU is registered
</span></span></span><span class=line><span class=cl><span class=c1></span><span class=kd>function</span> <span class=nx>CheckSKU</span><span class=p>(){</span>
</span></span><span class=line><span class=cl>	<span class=c1>// Check product registration if inside product page
</span></span></span><span class=line><span class=cl><span class=c1></span>	<span class=k>if</span><span class=p>(</span><span class=nx>currentVariantSku</span> <span class=o>&amp;&amp;</span> <span class=nx>tryonButton</span><span class=p>){</span>
</span></span><span class=line><span class=cl>	<span class=nx>tryonButton</span><span class=p>.</span><span class=nx>style</span><span class=p>.</span><span class=nx>display</span> <span class=o>=</span> <span class=s2>&#34;none&#34;</span><span class=p>;</span>
</span></span><span class=line><span class=cl>		<span class=nx>SprieSDK</span><span class=p>.</span><span class=nx>CheckSKU</span><span class=p>(</span><span class=nx>currentVariantSku</span><span class=p>).</span><span class=nx>then</span><span class=p>(</span><span class=nx>checkResult</span><span class=p>=&gt;{</span>
</span></span><span class=line><span class=cl>		<span class=nx>tryonButton</span><span class=p>.</span><span class=nx>style</span><span class=p>.</span><span class=nx>display</span> <span class=o>=</span> <span class=nx>checkResult</span><span class=p>[</span><span class=nx>productSku</span><span class=p>]</span><span class=o>?</span><span class=s2>&#34;block&#34;</span><span class=o>:</span><span class=s2>&#34;none&#34;</span><span class=p>;</span>
</span></span><span class=line><span class=cl>		<span class=p>});</span>
</span></span><span class=line><span class=cl>	<span class=p>}</span>
</span></span><span class=line><span class=cl><span class=p>}</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c1>// Check with server if product is registered
</span></span></span><span class=line><span class=cl><span class=c1></span><span class=nb>document</span><span class=p>.</span><span class=nx>addEventListener</span><span class=p>(</span><span class=s2>&#34;SprieEvent:onSDKReady&#34;</span><span class=p>,</span> <span class=kd>function</span><span class=p>(</span><span class=nx>e</span><span class=p>){</span>
</span></span><span class=line><span class=cl>	<span class=nx>CheckSKU</span><span class=p>();</span>
</span></span><span class=line><span class=cl><span class=p>});</span> 
</span></span></code></pre></div><p>Here, we are listening to <code>onSDKReady</code> event, then checking of productSku is not null, and then using <a href=https://docs.sprie.io/docs/methods>Sprie Methods</a> to check product registration with Sprie. Once the result is received, we immeidtaely show/hide the tryon button that we created in step 2.</p><h3 id=5-handle-add-to-cart>5. Handle Add to Cart</h3><p>Sprie offers a Add to Cart CTA on the widget which raises an event with the specific product SKU. You can listen to the event and decide what to do with the Event itself. The reason we do not provide any backend action is because Sprie simply doesn&rsquo;t depende/ bother the frameowkr you are working on and leaves it upto you to decide how you want to implement it.
As an example, in Wordpress + Woocommerce setup, you can add it to card in the following way :</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-JS data-lang=JS><span class=line><span class=cl><span class=c1>// Handle Add to Cart
</span></span></span><span class=line><span class=cl><span class=c1></span><span class=nb>document</span><span class=p>.</span><span class=nx>addEventListener</span><span class=p>(</span><span class=s2>&#34;SprieEvent:onAssetCart&#34;</span><span class=p>,</span> <span class=p>(</span><span class=nx>e</span><span class=p>)=&gt;{</span>
</span></span><span class=line><span class=cl>	<span class=nx>console</span><span class=p>.</span><span class=nx>log</span><span class=p>(</span><span class=s1>&#39;Added to cart: &#39;</span><span class=p>,</span><span class=nx>e</span><span class=p>.</span><span class=nx>detail</span> <span class=p>);</span>
</span></span><span class=line><span class=cl><span class=p>});</span>
</span></span></code></pre></div><p>This particular code uses <code>onAssetCart</code> event from Sprie to POST to <code>/wp-json/wc/store/cart/add-item</code> api from woo commerce to add the item to cart usig jQuery&rsquo;s <code>ajax</code> method, which is by default installed in a wordpress setup.</p><h3 id=6-handle-variants-changes>6. Handle Variants changes</h3><p>in <code>sections> footer.liquid</code>, put this code after the previous step:</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-JS data-lang=JS><span class=line><span class=cl><span class=c1>// Handle Variant Change
</span></span></span><span class=line><span class=cl><span class=c1></span><span class=kd>function</span> <span class=nx>onVariantChange</span><span class=p>(</span><span class=nx>event</span><span class=p>)</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>	<span class=nx>console</span><span class=p>.</span><span class=nx>log</span><span class=p>(</span><span class=s1>&#39;Checked radio with ID = &#39;</span> <span class=o>+</span> <span class=nx>event</span><span class=p>.</span><span class=nx>target</span><span class=p>.</span><span class=nx>getAttribute</span><span class=p>(</span><span class=s1>&#39;data-sku&#39;</span><span class=p>));</span>
</span></span><span class=line><span class=cl>	<span class=nx>currentVariantSku</span><span class=o>=</span><span class=nx>event</span><span class=p>.</span><span class=nx>target</span><span class=p>.</span><span class=nx>getAttribute</span><span class=p>(</span><span class=s1>&#39;data-sku&#39;</span><span class=p>);</span>
</span></span><span class=line><span class=cl>	<span class=nx>CheckSKU</span><span class=p>();</span>
</span></span><span class=line><span class=cl><span class=p>}</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=kr>const</span> <span class=nx>variantElements</span><span class=o>=</span> <span class=nb>document</span><span class=p>.</span><span class=nx>querySelectorAll</span><span class=p>(</span><span class=s1>&#39;input[name=&#34;Color&#34;]&#39;</span><span class=p>);</span>
</span></span><span class=line><span class=cl><span class=nx>console</span><span class=p>.</span><span class=nx>log</span><span class=p>({</span><span class=nx>variantElements</span><span class=p>});</span>
</span></span><span class=line><span class=cl><span class=nx>variantElements</span><span class=p>.</span><span class=nx>forEach</span><span class=p>((</span><span class=nx>input</span><span class=p>)</span> <span class=p>=&gt;</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>	<span class=kd>let</span> <span class=nx>selectedVariant</span> <span class=o>=</span> <span class=nx>currentProduct</span><span class=p>.</span><span class=nx>variants</span><span class=p>.</span><span class=nx>find</span><span class=p>(</span><span class=nx>variant</span> <span class=p>=&gt;</span> <span class=nx>variant</span><span class=p>.</span><span class=nx>name</span> <span class=o>===</span> <span class=nx>input</span><span class=p>.</span><span class=nx>value</span> <span class=o>||</span> <span class=nx>variant</span><span class=p>.</span><span class=nx>option1</span> <span class=o>===</span> <span class=nx>input</span><span class=p>.</span><span class=nx>value</span><span class=p>);</span>
</span></span><span class=line><span class=cl>	<span class=nx>input</span><span class=p>.</span><span class=nx>setAttribute</span><span class=p>(</span><span class=s1>&#39;data-sku&#39;</span><span class=p>,</span> <span class=nx>selectedVariant</span><span class=p>.</span><span class=nx>sku</span> <span class=o>||</span> <span class=nx>productSku</span><span class=p>);</span>
</span></span><span class=line><span class=cl>	<span class=nx>input</span><span class=p>.</span><span class=nx>addEventListener</span><span class=p>(</span><span class=s1>&#39;change&#39;</span><span class=p>,</span> <span class=nx>onVariantChange</span><span class=p>);</span>
</span></span><span class=line><span class=cl><span class=p>});</span>
</span></span></code></pre></div><p>We check for radio button clicks and run <code>CheckSKU</code> on them and enable the Preview <code>TryOn</code> button accordingly.</p><h3 id=7-next-steps>7. Next Steps</h3><p>We are in the process of creatign a plugin which will do all these on your behalf. Once we have completely tested the code, we will announce it and let you know.</p><h3 id=8-full-code>8. Full Code</h3><p>Code in <code>sections> footer.liquid</code> :</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-HTML data-lang=HTML><span class=line><span class=cl><span class=c>&lt;!-- Sprie --&gt;</span>
</span></span><span class=line><span class=cl><span class=p>&lt;</span><span class=nt>script</span> <span class=na>src</span><span class=o>=</span><span class=s>&#34;https://cdn.jsdelivr.net/npm/@perceptimagery/sprie-widget@latest&#34;</span><span class=p>&gt;&lt;/</span><span class=nt>script</span><span class=p>&gt;</span>
</span></span><span class=line><span class=cl><span class=p>&lt;</span><span class=nt>div</span> <span class=na>id</span><span class=o>=</span><span class=s>&#34;sdk-widget&#34;</span> <span class=na>data-apikey</span><span class=o>=</span><span class=s>&#34;579e87f3b327061b39&#34;</span><span class=p>&gt;&lt;/</span><span class=nt>div</span><span class=p>&gt;</span>
</span></span><span class=line><span class=cl><span class=p>&lt;</span><span class=nt>script</span><span class=p>&gt;</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>  <span class=c1>// Utilities
</span></span></span><span class=line><span class=cl><span class=c1></span>  <span class=kr>const</span> <span class=nx>params</span> <span class=o>=</span> <span class=k>new</span> <span class=nb>Proxy</span><span class=p>(</span><span class=k>new</span> <span class=nx>URLSearchParams</span><span class=p>(</span><span class=nb>window</span><span class=p>.</span><span class=nx>location</span><span class=p>.</span><span class=nx>search</span><span class=p>),</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>    <span class=nx>get</span><span class=o>:</span> <span class=p>(</span><span class=nx>searchParams</span><span class=p>,</span> <span class=nx>prop</span><span class=p>)</span> <span class=p>=&gt;</span> <span class=nx>searchParams</span><span class=p>.</span><span class=nx>get</span><span class=p>(</span><span class=nx>prop</span><span class=p>),</span>
</span></span><span class=line><span class=cl>  <span class=p>});</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>	<span class=c1>// Fetch Product Specific Data
</span></span></span><span class=line><span class=cl><span class=c1></span>	<span class=kr>const</span> <span class=nx>urlPath</span> <span class=o>=</span> <span class=nb>window</span><span class=p>.</span><span class=nx>location</span><span class=p>.</span><span class=nx>pathname</span><span class=p>;</span>
</span></span><span class=line><span class=cl>	<span class=kr>const</span> <span class=nx>productSku</span> <span class=o>=</span> <span class=nx>urlPath</span><span class=p>.</span><span class=nx>indexOf</span><span class=p>(</span><span class=s1>&#39;products/&#39;</span><span class=p>)</span><span class=o>&gt;=</span><span class=mi>0</span> <span class=o>?</span> <span class=nx>urlPath</span><span class=p>.</span><span class=nx>replace</span><span class=p>(</span><span class=s1>&#39;products&#39;</span><span class=p>,</span><span class=s1>&#39;&#39;</span><span class=p>).</span><span class=nx>replaceAll</span><span class=p>(</span><span class=s1>&#39;/&#39;</span><span class=p>,</span><span class=s1>&#39;&#39;</span><span class=p>).</span><span class=nx>trim</span><span class=p>()</span> <span class=o>:</span> <span class=s1>&#39;&#39;</span><span class=p>;</span>
</span></span><span class=line><span class=cl>  <span class=kr>const</span> <span class=nx>currentVariantId</span> <span class=o>=</span> <span class=nx>params</span><span class=p>.</span><span class=nx>variant</span> <span class=o>||</span> <span class=kc>null</span><span class=p>;</span>
</span></span><span class=line><span class=cl>  <span class=kr>const</span> <span class=nx>currentProduct</span><span class=o>=</span> <span class=p>{{</span> <span class=nx>product</span> <span class=o>|</span> <span class=nx>json</span> <span class=p>}};</span>
</span></span><span class=line><span class=cl>  <span class=kr>const</span> <span class=nx>variantIdSkuMap</span><span class=o>=</span> <span class=o>!!</span><span class=nx>currentProduct</span>  <span class=o>?</span> <span class=nx>currentProduct</span><span class=p>.</span><span class=nx>variants</span><span class=p>.</span><span class=nx>reduce</span><span class=p>((</span><span class=nx>acc</span><span class=p>,</span><span class=nx>curr</span><span class=p>)=&gt;{</span>      
</span></span><span class=line><span class=cl>    <span class=nx>acc</span><span class=p>[</span><span class=nx>curr</span><span class=p>.</span><span class=nx>id</span><span class=p>]</span><span class=o>=</span><span class=nx>curr</span><span class=p>.</span><span class=nx>sku</span> <span class=o>||</span> <span class=nx>productSku</span><span class=p>;</span>
</span></span><span class=line><span class=cl>    <span class=k>return</span> <span class=nx>acc</span><span class=p>;</span>
</span></span><span class=line><span class=cl>  <span class=p>},{})</span><span class=o>:</span> <span class=p>{};</span>
</span></span><span class=line><span class=cl>  <span class=kd>let</span> <span class=nx>currentVariantSku</span> <span class=o>=</span> <span class=nx>variantIdSkuMap</span><span class=p>[</span><span class=nx>currentVariantId</span><span class=p>]</span> <span class=o>||</span> <span class=nx>productSku</span> <span class=o>||</span> <span class=kc>null</span><span class=p>;</span>
</span></span><span class=line><span class=cl>  <span class=kr>const</span> <span class=nx>tryonButton</span> <span class=o>=</span> <span class=nb>document</span><span class=p>.</span><span class=nx>getElementById</span><span class=p>(</span><span class=s1>&#39;tryon-button&#39;</span><span class=p>);</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>  <span class=c1>// Check SKU is registered
</span></span></span><span class=line><span class=cl><span class=c1></span>  <span class=kd>function</span> <span class=nx>CheckSKU</span><span class=p>(){</span>
</span></span><span class=line><span class=cl>		<span class=c1>// Check product registration if inside product page
</span></span></span><span class=line><span class=cl><span class=c1></span>    <span class=k>if</span><span class=p>(</span><span class=nx>currentVariantSku</span> <span class=o>&amp;&amp;</span> <span class=nx>tryonButton</span><span class=p>){</span>
</span></span><span class=line><span class=cl>      <span class=nx>tryonButton</span><span class=p>.</span><span class=nx>style</span><span class=p>.</span><span class=nx>display</span> <span class=o>=</span> <span class=s2>&#34;none&#34;</span><span class=p>;</span>
</span></span><span class=line><span class=cl>			<span class=nx>SprieSDK</span><span class=p>.</span><span class=nx>CheckSKU</span><span class=p>(</span><span class=nx>currentVariantSku</span><span class=p>).</span><span class=nx>then</span><span class=p>(</span><span class=nx>checkResult</span><span class=p>=&gt;{</span>
</span></span><span class=line><span class=cl>         <span class=nx>tryonButton</span><span class=p>.</span><span class=nx>style</span><span class=p>.</span><span class=nx>display</span> <span class=o>=</span> <span class=nx>checkResult</span><span class=p>[</span><span class=nx>productSku</span><span class=p>]</span><span class=o>?</span><span class=s2>&#34;block&#34;</span><span class=o>:</span><span class=s2>&#34;none&#34;</span><span class=p>;</span>
</span></span><span class=line><span class=cl>			<span class=p>});</span>
</span></span><span class=line><span class=cl>		<span class=p>}</span>
</span></span><span class=line><span class=cl>  <span class=p>}</span>
</span></span><span class=line><span class=cl>  <span class=c1>// Check with server if product is registered
</span></span></span><span class=line><span class=cl><span class=c1></span>  <span class=nb>document</span><span class=p>.</span><span class=nx>addEventListener</span><span class=p>(</span><span class=s2>&#34;SprieEvent:onSDKReady&#34;</span><span class=p>,</span> <span class=kd>function</span><span class=p>(</span><span class=nx>e</span><span class=p>){</span>
</span></span><span class=line><span class=cl>		<span class=nx>CheckSKU</span><span class=p>();</span>
</span></span><span class=line><span class=cl>  <span class=p>});</span> 
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>	<span class=c1>// Handle Add to Cart
</span></span></span><span class=line><span class=cl><span class=c1></span>	<span class=nb>document</span><span class=p>.</span><span class=nx>addEventListener</span><span class=p>(</span><span class=s2>&#34;SprieEvent:onAssetCart&#34;</span><span class=p>,</span> <span class=p>(</span><span class=nx>e</span><span class=p>)=&gt;{</span>
</span></span><span class=line><span class=cl>		<span class=nx>console</span><span class=p>.</span><span class=nx>log</span><span class=p>(</span><span class=s1>&#39;Added to cart: &#39;</span><span class=p>,</span><span class=nx>e</span><span class=p>.</span><span class=nx>detail</span> <span class=p>);</span>
</span></span><span class=line><span class=cl>	<span class=p>});</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>  <span class=c1>// Handle Variant Change
</span></span></span><span class=line><span class=cl><span class=c1></span>  <span class=kd>function</span> <span class=nx>onVariantChange</span><span class=p>(</span><span class=nx>event</span><span class=p>)</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>      <span class=nx>console</span><span class=p>.</span><span class=nx>log</span><span class=p>(</span><span class=s1>&#39;Checked radio with ID = &#39;</span> <span class=o>+</span> <span class=nx>event</span><span class=p>.</span><span class=nx>target</span><span class=p>.</span><span class=nx>getAttribute</span><span class=p>(</span><span class=s1>&#39;data-sku&#39;</span><span class=p>));</span>
</span></span><span class=line><span class=cl>      <span class=nx>currentVariantSku</span><span class=o>=</span><span class=nx>event</span><span class=p>.</span><span class=nx>target</span><span class=p>.</span><span class=nx>getAttribute</span><span class=p>(</span><span class=s1>&#39;data-sku&#39;</span><span class=p>);</span>
</span></span><span class=line><span class=cl>      <span class=nx>CheckSKU</span><span class=p>();</span>
</span></span><span class=line><span class=cl>  <span class=p>}</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>  <span class=kr>const</span> <span class=nx>variantElements</span><span class=o>=</span> <span class=nb>document</span><span class=p>.</span><span class=nx>querySelectorAll</span><span class=p>(</span><span class=s1>&#39;input[name=&#34;Color&#34;]&#39;</span><span class=p>);</span>
</span></span><span class=line><span class=cl>  <span class=nx>console</span><span class=p>.</span><span class=nx>log</span><span class=p>({</span><span class=nx>variantElements</span><span class=p>});</span>
</span></span><span class=line><span class=cl>  <span class=nx>variantElements</span><span class=p>.</span><span class=nx>forEach</span><span class=p>((</span><span class=nx>input</span><span class=p>)</span> <span class=p>=&gt;</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>      <span class=kd>let</span> <span class=nx>selectedVariant</span> <span class=o>=</span> <span class=nx>currentProduct</span><span class=p>.</span><span class=nx>variants</span><span class=p>.</span><span class=nx>find</span><span class=p>(</span><span class=nx>variant</span> <span class=p>=&gt;</span> <span class=nx>variant</span><span class=p>.</span><span class=nx>name</span> <span class=o>===</span> <span class=nx>input</span><span class=p>.</span><span class=nx>value</span> <span class=o>||</span> <span class=nx>variant</span><span class=p>.</span><span class=nx>option1</span> <span class=o>===</span> <span class=nx>input</span><span class=p>.</span><span class=nx>value</span><span class=p>);</span>
</span></span><span class=line><span class=cl>      <span class=nx>input</span><span class=p>.</span><span class=nx>setAttribute</span><span class=p>(</span><span class=s1>&#39;data-sku&#39;</span><span class=p>,</span> <span class=nx>selectedVariant</span><span class=p>.</span><span class=nx>sku</span> <span class=o>||</span> <span class=nx>productSku</span><span class=p>);</span>
</span></span><span class=line><span class=cl>      <span class=nx>input</span><span class=p>.</span><span class=nx>addEventListener</span><span class=p>(</span><span class=s1>&#39;change&#39;</span><span class=p>,</span> <span class=nx>onVariantChange</span><span class=p>);</span>
</span></span><span class=line><span class=cl>  <span class=p>});</span>
</span></span><span class=line><span class=cl><span class=p>&lt;/</span><span class=nt>script</span><span class=p>&gt;</span>
</span></span></code></pre></div><p><code>sections > main-product.liquid</code> :</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-HTML data-lang=HTML><span class=line><span class=cl><span class=p>&lt;</span><span class=nt>button</span>
</span></span><span class=line><span class=cl>	<span class=na>id</span><span class=o>=</span><span class=s>&#34;tryon-button&#34;</span>
</span></span><span class=line><span class=cl>	<span class=na>type</span><span class=o>=</span><span class=s>&#34;button&#34;</span>
</span></span><span class=line><span class=cl>	<span class=na>name</span><span class=o>=</span><span class=s>&#34;tryon&#34;</span>
</span></span><span class=line><span class=cl>	<span class=na>style</span><span class=o>=</span><span class=s>&#34;display:none&#34;</span> 
</span></span><span class=line><span class=cl>	<span class=na>onclick</span><span class=o>=</span><span class=s>&#34;SprieSDK.Load(currentVariantSku)&#34;</span>
</span></span><span class=line><span class=cl>	<span class=na>class</span><span class=o>=</span><span class=s>&#34;product-form__submit button button--full-width button--secondary&#34;</span>
</span></span><span class=line><span class=cl>	<span class=p>&gt;</span>
</span></span><span class=line><span class=cl>	<span class=p>&lt;</span><span class=nt>span</span><span class=p>&gt;</span>
</span></span><span class=line><span class=cl>		Try on
</span></span><span class=line><span class=cl>	<span class=p>&lt;/</span><span class=nt>span</span><span class=p>&gt;</span>
</span></span><span class=line><span class=cl><span class=p>&lt;/</span><span class=nt>button</span><span class=p>&gt;</span>
</span></span></code></pre></div></div></div></div></div></div></div><div class=sub-footer><div class=container><div class=row><div class=col-12><div class=sub-footer-inner><ul><li class=zerostatic><a href=https://www.sprie.io>www.sprie.io</a></li></ul></div></div></div></div></div><script type=text/javascript src=/js/scripts.min.55e8e1e2e7596c9a982bc04119cee1e2d4624c4c5a2dc0e9eb63ce401be14a24.js></script></body></html>