<!doctype html><html lang=en><head><meta charset=utf-8><meta http-equiv=x-ua-compatible content="ie=edge"><title>Events - Sprie Widget Docs</title><meta name=viewport content="width=device-width,initial-scale=1"><link rel=icon href=https://docs.sprie.io/favicon.ico><link rel=stylesheet href=/css/style.min.6719d72e323121369d5caeb4264b95d8a63cf1deaab029da67602fe5a046e0a4.css></head><body class="page page-default-single"><div id=main-menu-mobile class=main-menu-mobile><ul><li class=menu-item-home><a href=/><span>Home</span></a></li><li class=menu-item-docs><a href=/docs/><span>Docs</span></a></li></ul></div><div class=wrapper><div class=header><div class=container><div class=logo><a href=https://docs.sprie.io><img alt=Logo src=/images/logo.png></a></div><div class=logo-mobile><a href=https://docs.sprie.io><img alt=Logo src=/images/logo.png></a></div><div id=main-menu class=main-menu><ul><li class=menu-item-home><a href=/><span>Home</span></a></li><li class=menu-item-docs><a href=/docs/><span>Docs</span></a></li></ul></div><button id=toggle-main-menu-mobile class="hamburger hamburger--slider" type=button>
<span class=hamburger-box><span class=hamburger-inner></span></span></button></div></div><div class="container pt-2 pt-md-6 pb-3 pb-md-6"><div class=row><div class="col-12 col-md-3 mb-3"><div class=sidebar><div class=docs-menu><h4>Docs</h4><ul><li><a href=https://docs.sprie.io/docs/concept/>Concepts</a></li><li><a href=https://docs.sprie.io/docs/quick-start/>Quick Start Guide</a></li><li class=active><a href=https://docs.sprie.io/docs/events/>Events</a></li><li><a href=https://docs.sprie.io/docs/methods/>Methods</a></li><li><a href=https://docs.sprie.io/docs/wordpress/>Wordpress</a></li><li><a href=https://docs.sprie.io/docs/shopify/>Shopify</a></li><li><a href=https://docs.sprie.io/docs/react/>React</a></li><li><a href=https://docs.sprie.io/docs/troubleshoot/>Troubleshoot</a></li></ul></div></div></div><div class="col-12 col-md-9"><h1 class=title>Events</h1><div class=content><h2 id=-summary>‚ú® Summary</h2><p><code>SprieSDK</code> dispatches certain events to the document in the browser which can be listened for to get certain hooks/results and changing the default experience of Sprie.<br>All Sprie Events are prefixed with <code>SprieEvent:</code> to avoid conflict with other events dispatched globally in the DOM window by other libraries.</p><h2 id=events-reference>Events Reference</h2><p>All Events are based on <code>CustomEvent</code> or <code>Event</code>. You can find the respective data for particular event by standard event.detail.[field].</p><ol><li><p>Auth</p><ol><li>SprieEvent:onAuthLoading ({isLoading: boolean})</li><li>SprieEvent:onAuthOk ()</li><li>SprieEvent:onAuthErr ({err: string})</li><li>SprieEvent:onSDKReady ()</li><li>SprieEvent:onSDKErr ({err: string})</li><li>SprieEvent:AuthDone ()</li></ol></li><li><p>IO</p><ol><li>SprieEvent:onCameraAllowed ( )</li><li>SprieEvent:onCameraDenied ( )</li><li>SprieEvent:onCameraError ({err: string})</li></ol></li><li><p>Assets</p><ol><li>SprieEvent:onAssetCart ({sku: string})</li><li>SprieEvent:onAssetWishlist ({sku : string})</li><li>SprieEvent:onAssetLoading ({sku: string, isLoading: boolean})</li><li>SprieEvent:onAssetLoadOk ({sku: string})</li><li>SprieEvent:onAssetLoadErr ({sku: string, err: string})</li><li>SprieEvent:onCheckAssetSKU ({sku: boolean}). e.g. Response : {&lsquo;your-product-sku&rsquo;:true} // if it already exists</li><li>SprieEvent:onCheckAssetSKUBatch ({sku: boolean, ‚Ä¶ }). e.g. Response : {&lsquo;your-product-sku&rsquo;:true, &lsquo;sku-2&rsquo;:false}</li></ol></li><li><p>Widget</p><ol><li>SprieEvent:onWidgetMinimised ()</li></ol></li></ol><h2 id=examples>Examples</h2><h3 id=-simple-events-example>üì∑ Simple Events Example</h3><p>Considering the previous getting started example, write this code in a script tag below it or, add it to a separate file and import it in the <code>index.html</code> file.</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-javascript data-lang=javascript><span class=line><span class=cl><span class=c1>// app.js
</span></span></span><span class=line><span class=cl><span class=c1>// Listen when Add to Cart button is pressed on Sprie Widget
</span></span></span><span class=line><span class=cl><span class=c1></span><span class=nb>document</span><span class=p>.</span><span class=nx>addEventListener</span><span class=p>(</span><span class=s2>&#34;SprieEvent:onAssetCart&#34;</span><span class=p>,</span> <span class=kd>function</span> <span class=p>(</span><span class=nx>e</span><span class=p>)</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>    <span class=c1>// e.g. send async/ajax request to an endpoint to add to cart
</span></span></span><span class=line><span class=cl><span class=c1></span>    <span class=nx>alert</span><span class=p>(</span><span class=s2>&#34;Added to cart &#34;</span> <span class=o>+</span> <span class=nx>e</span><span class=p>.</span><span class=nx>detail</span><span class=p>.</span><span class=nx>sku</span><span class=p>);</span>
</span></span><span class=line><span class=cl><span class=p>});</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c1>// Check if Camera permission was denied
</span></span></span><span class=line><span class=cl><span class=c1></span><span class=nb>document</span><span class=p>.</span><span class=nx>addEventListener</span><span class=p>(</span><span class=s2>&#34;SprieEvent:onCameraDenied&#34;</span><span class=p>,</span> <span class=kd>function</span> <span class=p>(</span><span class=nx>e</span><span class=p>)</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>    <span class=nx>alert</span><span class=p>(</span><span class=s2>&#34;Camera Denied!&#34;</span><span class=p>);</span>
</span></span><span class=line><span class=cl><span class=p>});</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c1>// Check if Camera device is present or not.
</span></span></span><span class=line><span class=cl><span class=c1></span><span class=nb>document</span><span class=p>.</span><span class=nx>addEventListener</span><span class=p>(</span><span class=s2>&#34;SprieEvent:onCameraError&#34;</span><span class=p>,</span> <span class=kd>function</span> <span class=p>(</span><span class=nx>e</span><span class=p>)</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>    <span class=nx>alert</span><span class=p>(</span><span class=s2>&#34;Camera Error : &#34;</span> <span class=o>+</span> <span class=nx>e</span><span class=p>.</span><span class=nx>detail</span><span class=p>.</span><span class=nx>err</span><span class=p>);</span>
</span></span><span class=line><span class=cl><span class=p>});</span>
</span></span></code></pre></div><p>Line 5-8: Listen for SprieEvent:onAssetCart event which gets triggered on user clicking Add To Cart button.</p><p>Line 11-13: Listen for SprieEvent:onCameraDenied event which gets triggered in case the user denies camera permission in the browser.</p><p>Line 16-18: Listen for SprieEvent:onCameraError event which gets triggered in case of invalid/no camera is found.</p><h3 id=-check-sku-registration-example>üéÅ Check SKU registration Example</h3><p>You might have some products displayed on your website that might not be registered with Sprie.
To disable the Preview button for such scenarios on a template based environment (Wordpress), you can check beforehand if the sku exists with Sprie or not and set the Preview Button visibility accordingly.<br><em>NOTE</em>: This method must be called only after successful authentication of Sprie with apiKey otherwise the request gets rejected due to invalid auth token. <em>All requests from SprieSDK internally sends an auth token that is received from authentication request, and is handled and managed internally.</em></p><div class=highlight><pre tabindex=0 class=chroma><code class=language-javascript data-lang=javascript><span class=line><span class=cl><span class=c1>// app.js
</span></span></span><span class=line><span class=cl><span class=c1></span><span class=kr>const</span> <span class=nx>sku</span> <span class=o>=</span> <span class=s1>&#39;my-precious-sku&#39;</span><span class=p>;</span> 
</span></span><span class=line><span class=cl><span class=kd>var</span> <span class=nx>showPreviewButton</span> <span class=o>=</span> <span class=kc>false</span><span class=p>;</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=kd>var</span> <span class=nx>onAuthDoneHandler</span> <span class=o>=</span> <span class=kd>function</span> <span class=p>(){</span>
</span></span><span class=line><span class=cl>    <span class=nx>SprieSDK</span><span class=p>.</span><span class=nx>CheckSKU</span><span class=p>(</span><span class=nx>sku</span><span class=p>);</span>
</span></span><span class=line><span class=cl><span class=p>}</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=kd>var</span> <span class=nx>onCheckSKUHandler</span> <span class=o>=</span> <span class=kd>function</span> <span class=p>(</span><span class=nx>e</span><span class=p>){</span>
</span></span><span class=line><span class=cl>    <span class=kr>const</span> <span class=nx>result</span> <span class=o>=</span> <span class=nx>e</span><span class=p>.</span><span class=nx>detail</span><span class=p>;</span> <span class=c1>// {&#39;my-precious-sku&#39;:true}
</span></span></span><span class=line><span class=cl><span class=c1></span>    <span class=k>if</span><span class=p>(</span><span class=nx>result</span> <span class=o>&amp;&amp;</span> <span class=nb>Object</span><span class=p>.</span><span class=nx>keys</span><span class=p>(</span><span class=nx>result</span><span class=p>)[</span><span class=mi>0</span><span class=p>]</span><span class=o>===</span><span class=nx>sku</span><span class=p>){</span>
</span></span><span class=line><span class=cl>        <span class=nx>showPreviewButton</span> <span class=o>=</span> <span class=nx>result</span><span class=p>[</span><span class=nx>sku</span><span class=p>];</span>
</span></span><span class=line><span class=cl>    <span class=p>}</span>
</span></span><span class=line><span class=cl><span class=p>}</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=nb>document</span><span class=p>.</span><span class=nx>addEventListener</span><span class=p>(</span><span class=s2>&#34;SprieEvent:onAuthOk&#34;</span><span class=p>,</span> <span class=nx>onAuthDoneHandler</span><span class=p>);</span>
</span></span><span class=line><span class=cl><span class=nb>document</span><span class=p>.</span><span class=nx>addEventListener</span><span class=p>(</span><span class=s2>&#34;SprieEvent:onCheckAssetSKU&#34;</span><span class=p>,</span> <span class=nx>onCheckSKUHandler</span><span class=p>);</span>
</span></span></code></pre></div><h3 id=-check-multiple-skus-registration-example>üéÅüíêüíù Check Multiple SKUs registration Example</h3><p>To handle multiple SKUs, SprieSDK exposes a batch method <code>CheckSKUBatch</code>. You can send an array of SKUs and it can respond with all the SKUs with boolean data to signify if it exists with Sprie. You can easily use it in a product list page.</p><p><em>NOTE</em>: To maintain sanity of page load time, and requests timeouts, you can send at-most 50 SKUs in a single batch request but we recommend sending 20 SKUs for better performance and relay the rest on pagination/lazy loading techniques.</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-javascript data-lang=javascript><span class=line><span class=cl><span class=kd>var</span> <span class=nx>skuArray</span> <span class=o>=</span> <span class=p>[</span><span class=s1>&#39;my-precious-sku&#39;</span><span class=p>,</span><span class=s1>&#39;my-secondary-sku&#39;</span><span class=p>];</span> 
</span></span><span class=line><span class=cl><span class=kd>var</span> <span class=nx>validSkus</span> <span class=o>=</span> <span class=p>[];</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=kr>const</span> <span class=nx>onAuthDone</span> <span class=o>=</span> <span class=kd>function</span> <span class=p>(){</span>
</span></span><span class=line><span class=cl>    <span class=nx>SprieSDK</span><span class=p>.</span><span class=nx>CheckSKUBatch</span><span class=p>(</span><span class=nx>skuArray</span><span class=p>);</span>
</span></span><span class=line><span class=cl><span class=p>}</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=kr>const</span> <span class=nx>onCheckSKUBatch</span> <span class=o>=</span> <span class=kd>function</span> <span class=p>(</span><span class=nx>e</span><span class=p>){</span>
</span></span><span class=line><span class=cl>    <span class=kr>const</span> <span class=nx>result</span> <span class=o>=</span> <span class=nx>e</span><span class=p>.</span><span class=nx>detail</span><span class=p>;</span> <span class=c1>// [{ &#39;my-precious-sku&#39;:true, &#39;my-secondary-sku&#39;:false }]
</span></span></span><span class=line><span class=cl><span class=c1></span>    <span class=nx>validSkus</span> <span class=o>=</span> <span class=nb>Object</span><span class=p>.</span><span class=nx>keys</span><span class=p>(</span><span class=nx>result</span><span class=p>).</span><span class=nx>map</span><span class=p>(</span><span class=nx>x</span><span class=p>=&gt;</span><span class=nx>x</span><span class=p>).</span><span class=nx>filter</span><span class=p>(</span><span class=nx>x</span><span class=p>=&gt;</span><span class=nx>result</span><span class=p>[</span><span class=nx>x</span><span class=p>]).</span><span class=nx>map</span><span class=p>(</span><span class=nx>x</span><span class=p>=&gt;</span><span class=nx>x</span><span class=p>);</span> <span class=c1>// validSkus=[&#39;my-precious-sku&#39;];
</span></span></span><span class=line><span class=cl><span class=c1></span><span class=p>}</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=nb>document</span><span class=p>.</span><span class=nx>addEventListener</span><span class=p>(</span><span class=s2>&#34;SprieEvent:onAuthOk&#34;</span><span class=p>,</span> <span class=nx>onAuthDone</span><span class=p>);</span>
</span></span><span class=line><span class=cl><span class=nb>document</span><span class=p>.</span><span class=nx>addEventListener</span><span class=p>(</span><span class=s2>&#34;SprieEvent:onCheckAssetSKUBatch&#34;</span><span class=p>,</span> <span class=nx>onCheckSKUBatch</span><span class=p>);</span>
</span></span></code></pre></div><h4 id=hide-widget-on-minimise>Hide widget on minimise</h4><p>This code hides the widget on receiving the <code>onWidgetMinimised</code> event callback</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-javascript data-lang=javascript><span class=line><span class=cl><span class=o>&lt;</span><span class=nx>script</span><span class=o>&gt;</span>
</span></span><span class=line><span class=cl>     <span class=nb>document</span><span class=p>.</span><span class=nx>addEventListener</span><span class=p>(</span><span class=s2>&#34;SprieEvent:onWidgetMinimised&#34;</span><span class=p>,</span> <span class=kd>function</span> <span class=p>()</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>        <span class=nx>SprieSDK</span><span class=p>.</span><span class=nx>Loader</span><span class=p>.</span><span class=nx>HideWidget</span><span class=p>();</span>
</span></span><span class=line><span class=cl>     <span class=p>});</span>
</span></span><span class=line><span class=cl><span class=o>&lt;</span><span class=err>/script&gt;</span>
</span></span></code></pre></div></div></div></div></div></div></div><div class=sub-footer><div class=container><div class=row><div class=col-12><div class=sub-footer-inner><ul><li class=zerostatic><a href=https://www.sprie.io>www.sprie.io</a></li></ul></div></div></div></div></div><script type=text/javascript src=/js/scripts.min.55e8e1e2e7596c9a982bc04119cee1e2d4624c4c5a2dc0e9eb63ce401be14a24.js></script></body></html>