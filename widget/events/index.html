<!doctype html><html lang=en><head><meta charset=utf-8><meta http-equiv=x-ua-compatible content="ie=edge"><title>Events - Sprie Widget Docs</title>
<meta name=viewport content="width=device-width,initial-scale=1"><link rel=icon href=https://docs.sprie.io/favicon.png><link rel=stylesheet href=/css/style.min.c0c5bdcc13e1ec0af46d8fb01468bc0865f94e32016b28486e9fdf359cc41af2.css></head><body class='page page-default-single'><div id=main-menu-mobile class=main-menu-mobile><ul><li class=menu-item-home><a href=/><span>Home</span></a></li><li class="menu-item-sprie widget"><a href=/widget/><span>Sprie Widget</span></a></li><li class="menu-item-sprie embed"><a href=/embed/><span>Sprie Embed</span></a></li></ul></div><div class=wrapper><div class=header><div class=container><div class=logo><a href=https://docs.sprie.io/><img width=70 height=70 alt=Logo src=/images/logo.png></a></div><div class=logo-mobile><a href=https://docs.sprie.io/><img width=70 height=70 alt=Logo src=/images/logo.png></a></div><div id=main-menu class=main-menu><ul><li class=menu-item-home><a href=/><span>Home</span></a></li><li class="menu-item-sprie widget"><a href=/widget/><span>Sprie Widget</span></a></li><li class="menu-item-sprie embed"><a href=/embed/><span>Sprie Embed</span></a></li></ul></div><button id=toggle-main-menu-mobile class="hamburger hamburger--slider" type=button>
<span class=hamburger-box><span class=hamburger-inner></span></span></button></div></div><div class="container pt-2 pt-md-6 pb-3 pb-md-6"><div class=row><div class="col-12 col-md-3 mb-3"><div class=sidebar><div class=docs-menu><h4>Widget</h4><ul><li><a href=https://docs.sprie.io/widget/concept/>Concepts</a></li><li><a href=https://docs.sprie.io/widget/quick-start/>Quick Start Guide</a></li><li class=active><a href=https://docs.sprie.io/widget/events/>Events</a></li><li><a href=https://docs.sprie.io/widget/methods/>Methods</a></li><li><a href=https://docs.sprie.io/widget/wordpress/>Wordpress</a></li><li><a href=https://docs.sprie.io/widget/shopify/>Shopify</a></li><li><a href=https://docs.sprie.io/widget/demos/>Live Demos</a></li></ul></div></div></div><div class="col-12 col-md-9"><h1 class=title>Events</h1><div class=content><h2 id=-summary>âœ¨ Summary</h2><p><code>SprieSDK</code> dispatches certain events to the document in the browser which can be listened for to get certain hooks/results and changing the default experience of Sprie.<br>All Sprie Events are prefixed with <code>SprieEvent:</code> to avoid conflict with other events dispatched globally in the DOM window by other libraries.</p><h2 id=events-reference>Events Reference</h2><p>All Events are based on <code>CustomEvent</code> or <code>Event</code>. You can find the respective data for particular event by standard event.detail.[field].</p><ol><li><p>Auth</p><ol><li>SprieEvent:onAuthLoading ({isLoading: boolean})</li><li>SprieEvent:onAuthErr ({err: string})</li><li>SprieEvent:onSDKReady ()</li><li>SprieEvent:onSDKErr ({err: string})</li><li>SprieEvent:AuthDone ()</li></ol></li><li><p>IO</p><ol><li>SprieEvent:onCameraAllowed ( )</li><li>SprieEvent:onCameraDenied ( )</li><li>SprieEvent:onCameraError ({err: string})</li><li>SprieEvent:onNoNetwork ()</li></ol></li><li><p>Assets</p><ol><li>SprieEvent:onAssetCart ({sku: string})</li><li>SprieEvent:onAssetWishlist ({sku : string})</li><li>SprieEvent:onAssetLoading ({sku: string, isLoading: boolean})</li><li>SprieEvent:onAssetLoadOk ({sku: string})</li><li>SprieEvent:onAssetLoadErr ({sku: string, err: string})</li><li>SprieEvent:onCheckAssetSKU ({sku: boolean}). e.g. Response : {&lsquo;your-product-sku&rsquo;:true} // if it already exists</li><li>SprieEvent:onCheckAssetSKUBatch ({sku: boolean, â€¦ }). e.g. Response : {&lsquo;your-product-sku&rsquo;:true, &lsquo;sku-2&rsquo;:false}</li></ol></li><li><p>Widget</p><ol><li>SprieEvent:onWidgetMinimized ()</li></ol></li></ol><h2 id=examples>Examples</h2><h3 id=-simple-events-example>ðŸ“· Simple Events Example</h3><p>Considering the quick start guide example code as a base, you can write this code in a script tag below it or add it to a separate file and import it in the <code>index.html</code> file.</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-javascript data-lang=javascript><span class=line><span class=cl><span class=c1>// app.js
</span></span></span><span class=line><span class=cl><span class=c1>// Listen when Add to Cart button is pressed on Sprie Widget
</span></span></span><span class=line><span class=cl><span class=c1></span><span class=nb>document</span><span class=p>.</span><span class=nx>addEventListener</span><span class=p>(</span><span class=s1>&#39;SprieEvent:onAssetCart&#39;</span><span class=p>,</span> <span class=kd>function</span> <span class=p>(</span><span class=nx>e</span><span class=p>)</span> <span class=p>{</span>
</span></span><span class=line><span class=cl> <span class=c1>// e.g. send async/ajax request to an endpoint to add to cart
</span></span></span><span class=line><span class=cl><span class=c1></span> <span class=nx>alert</span><span class=p>(</span><span class=s1>&#39;Added to cart &#39;</span> <span class=o>+</span> <span class=nx>e</span><span class=p>.</span><span class=nx>detail</span><span class=p>.</span><span class=nx>sku</span><span class=p>);</span>
</span></span><span class=line><span class=cl><span class=p>});</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c1>// Check if Camera permission was denied
</span></span></span><span class=line><span class=cl><span class=c1></span><span class=nb>document</span><span class=p>.</span><span class=nx>addEventListener</span><span class=p>(</span><span class=s1>&#39;SprieEvent:onCameraDenied&#39;</span><span class=p>,</span> <span class=kd>function</span> <span class=p>(</span><span class=nx>e</span><span class=p>)</span> <span class=p>{</span>
</span></span><span class=line><span class=cl> <span class=nx>alert</span><span class=p>(</span><span class=s1>&#39;Camera Denied!&#39;</span><span class=p>);</span>
</span></span><span class=line><span class=cl><span class=p>});</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c1>// Check if Camera device is present or not.
</span></span></span><span class=line><span class=cl><span class=c1></span><span class=nb>document</span><span class=p>.</span><span class=nx>addEventListener</span><span class=p>(</span><span class=s1>&#39;SprieEvent:onCameraError&#39;</span><span class=p>,</span> <span class=kd>function</span> <span class=p>(</span><span class=nx>e</span><span class=p>)</span> <span class=p>{</span>
</span></span><span class=line><span class=cl> <span class=nx>alert</span><span class=p>(</span><span class=s1>&#39;Camera Error : &#39;</span> <span class=o>+</span> <span class=nx>e</span><span class=p>.</span><span class=nx>detail</span><span class=p>.</span><span class=nx>err</span><span class=p>);</span>
</span></span><span class=line><span class=cl><span class=p>});</span>
</span></span></code></pre></div><p>Line 5-8: Listen for SprieEvent:onAssetCart event which gets triggered on user clicking Add To Cart button.</p><p>Line 11-13: Listen for SprieEvent:onCameraDenied event which gets triggered in case the user denies camera permission in the browser.</p><p>Line 16-18: Listen for SprieEvent:onCameraError event which gets triggered in case of invalid/no camera is found.</p><h3 id=check-sku-registration-example>Check SKU registration Example</h3><p>You might have some products displayed on your website that might not be registered with Sprie. To handle the Preview / Try On button for such scenarios in a template based environment (Wordpress / Shopify), you can check if the sku exists with Sprie or not and set the Preview / Try On Button visibility or text accordingly.</p><p>This method <strong>must</strong> be called only after successful authentication of Sprie with apiKey otherwise the request will get rejected due to invalid auth token.</p><p><em>NOTE: All requests from SprieSDK require an auth token which is generated on successful authentication. It is handled and managed internally by the SDK.</em></p><div class=highlight><pre tabindex=0 class=chroma><code class=language-javascript data-lang=javascript><span class=line><span class=cl><span class=c1>// app.js
</span></span></span><span class=line><span class=cl><span class=c1></span><span class=kr>const</span> <span class=nx>sku</span> <span class=o>=</span> <span class=s1>&#39;my-precious-sku&#39;</span><span class=p>;</span>
</span></span><span class=line><span class=cl><span class=kd>var</span> <span class=nx>showPreviewButton</span> <span class=o>=</span> <span class=kc>false</span><span class=p>;</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=kd>var</span> <span class=nx>onAuthDoneHandler</span> <span class=o>=</span> <span class=kd>function</span> <span class=p>()</span> <span class=p>{</span>
</span></span><span class=line><span class=cl> <span class=nx>SprieSDK</span><span class=p>.</span><span class=nx>CheckSKU</span><span class=p>(</span><span class=nx>sku</span><span class=p>);</span>
</span></span><span class=line><span class=cl><span class=p>};</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=kd>var</span> <span class=nx>onCheckSKUHandler</span> <span class=o>=</span> <span class=kd>function</span> <span class=p>(</span><span class=nx>e</span><span class=p>)</span> <span class=p>{</span>
</span></span><span class=line><span class=cl> <span class=kr>const</span> <span class=nx>result</span> <span class=o>=</span> <span class=nx>e</span><span class=p>.</span><span class=nx>detail</span><span class=p>;</span> <span class=c1>// {&#39;my-precious-sku&#39;:true}
</span></span></span><span class=line><span class=cl><span class=c1></span> <span class=k>if</span> <span class=p>(</span><span class=nx>result</span> <span class=o>&amp;&amp;</span> <span class=nb>Object</span><span class=p>.</span><span class=nx>keys</span><span class=p>(</span><span class=nx>result</span><span class=p>)[</span><span class=mi>0</span><span class=p>]</span> <span class=o>===</span> <span class=nx>sku</span><span class=p>)</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>  <span class=nx>showPreviewButton</span> <span class=o>=</span> <span class=nx>result</span><span class=p>[</span><span class=nx>sku</span><span class=p>];</span>
</span></span><span class=line><span class=cl> <span class=p>}</span>
</span></span><span class=line><span class=cl><span class=p>};</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=nb>document</span><span class=p>.</span><span class=nx>addEventListener</span><span class=p>(</span><span class=s1>&#39;SprieEvent:onAuthOk&#39;</span><span class=p>,</span> <span class=nx>onAuthDoneHandler</span><span class=p>);</span>
</span></span><span class=line><span class=cl><span class=nb>document</span><span class=p>.</span><span class=nx>addEventListener</span><span class=p>(</span><span class=s1>&#39;SprieEvent:onCheckAssetSKU&#39;</span><span class=p>,</span> <span class=nx>onCheckSKUHandler</span><span class=p>);</span>
</span></span></code></pre></div><h3 id=check-multiple-skus-registration-example>Check Multiple SKUs registration Example</h3><p>To handle multiple SKUs, SprieSDK exposes a batch method <code>CheckSKUBatch</code>. You can send an array of SKUs and it can respond with all the SKUs with boolean data to signify if it exists with Sprie. You can easily use it in a product list page.</p><p><em>NOTE: To maintain sanity of page load time, and requests timeouts, you can send at-most 50 SKUs in a single batch request but we recommend sending 20 SKUs for better performance and relay the rest on pagination/lazy loading techniques.</em></p><div class=highlight><pre tabindex=0 class=chroma><code class=language-javascript data-lang=javascript><span class=line><span class=cl><span class=kd>var</span> <span class=nx>skuArray</span> <span class=o>=</span> <span class=p>[</span><span class=s1>&#39;my-precious-sku&#39;</span><span class=p>,</span> <span class=s1>&#39;my-secondary-sku&#39;</span><span class=p>];</span>
</span></span><span class=line><span class=cl><span class=kd>var</span> <span class=nx>validSkus</span> <span class=o>=</span> <span class=p>[];</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=kr>const</span> <span class=nx>onAuthDone</span> <span class=o>=</span> <span class=kd>function</span> <span class=p>()</span> <span class=p>{</span>
</span></span><span class=line><span class=cl> <span class=nx>SprieSDK</span><span class=p>.</span><span class=nx>CheckSKUBatch</span><span class=p>(</span><span class=nx>skuArray</span><span class=p>);</span>
</span></span><span class=line><span class=cl><span class=p>};</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=kr>const</span> <span class=nx>onCheckSKUBatch</span> <span class=o>=</span> <span class=kd>function</span> <span class=p>(</span><span class=nx>e</span><span class=p>)</span> <span class=p>{</span>
</span></span><span class=line><span class=cl> <span class=kr>const</span> <span class=nx>result</span> <span class=o>=</span> <span class=nx>e</span><span class=p>.</span><span class=nx>detail</span><span class=p>;</span> <span class=c1>// [{ &#39;my-precious-sku&#39;:true, &#39;my-secondary-sku&#39;:false }]
</span></span></span><span class=line><span class=cl><span class=c1></span> <span class=nx>validSkus</span> <span class=o>=</span> <span class=nb>Object</span><span class=p>.</span><span class=nx>keys</span><span class=p>(</span><span class=nx>result</span><span class=p>)</span>
</span></span><span class=line><span class=cl>  <span class=p>.</span><span class=nx>map</span><span class=p>((</span><span class=nx>x</span><span class=p>)</span> <span class=p>=&gt;</span> <span class=nx>x</span><span class=p>)</span>
</span></span><span class=line><span class=cl>  <span class=p>.</span><span class=nx>filter</span><span class=p>((</span><span class=nx>x</span><span class=p>)</span> <span class=p>=&gt;</span> <span class=nx>result</span><span class=p>[</span><span class=nx>x</span><span class=p>])</span>
</span></span><span class=line><span class=cl>  <span class=p>.</span><span class=nx>map</span><span class=p>((</span><span class=nx>x</span><span class=p>)</span> <span class=p>=&gt;</span> <span class=nx>x</span><span class=p>);</span> <span class=c1>// validSkus=[&#39;my-precious-sku&#39;];
</span></span></span><span class=line><span class=cl><span class=c1></span><span class=p>};</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=nb>document</span><span class=p>.</span><span class=nx>addEventListener</span><span class=p>(</span><span class=s1>&#39;SprieEvent:onAuthOk&#39;</span><span class=p>,</span> <span class=nx>onAuthDone</span><span class=p>);</span>
</span></span><span class=line><span class=cl><span class=nb>document</span><span class=p>.</span><span class=nx>addEventListener</span><span class=p>(</span><span class=s1>&#39;SprieEvent:onCheckAssetSKUBatch&#39;</span><span class=p>,</span> <span class=nx>onCheckSKUBatch</span><span class=p>);</span>
</span></span></code></pre></div></div></div></div></div></div></div><div class=sub-footer><div class=container><div class=row><div class=col-12><div class=sub-footer-inner></div></div></div></div></div><script type=text/javascript src=/js/scripts.min.ec19db7e4836c12e2c5e3697d926bc3e4c22005167d9826aab54feca08f0c093.js></script></body></html>